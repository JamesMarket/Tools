# 亚马逊产品图片自动获取工具 V3

## 功能特点

1. **高清图片获取**
   - 自动获取亚马逊产品的最高清图片（1500px）
   - 支持多种图片格式（jpg/png）
   - 智能降级机制（1500 -> 1200 -> 1000 -> 800）

2. **智能URL处理**
   - 自动转换为标准高清格式
   - 支持多种亚马逊图片URL格式
   - 自动修正图片参数

3. **缓存机制**
   - 运行时缓存重复URL
   - 避免重复请求
   - 统计重用情况

4. **错误处理**
   - 完善的重试机制
   - 详细的错误日志
   - 多级容错处理

## 使用说明

### 1. 环境要求
- Python 3.6+
- 必要的Python包：
  - requests
  - seatable-api
  - Pillow

### 2. 配置参数
```python
SERVER_URL = 'https://cloud.seatable.cn'
API_TOKEN = '你的API令牌'
TABLE_NAME = '表格名称'
```

### 3. 运行程序
```bash
python get_amazon_images_v3.py
```

## 运行要求

- Python 3.6+
- 依赖包：
  - seatable-api
  - requests
  - urllib3

## 主要改进

1. **V3版本新特性**
   - 分页获取数据，突破1000条限制
   - 运行时缓存管理，提高效率
   - 图片URL验证功能
   - 更完善的错误处理

2. **性能优化**
   - 使用会话（Session）管理请求
   - 流式读取响应内容
   - 智能延迟控制

3. **可靠性提升**
   - 更强大的重试机制
   - 完整的异常处理
   - 自动恢复机制

## 统计信息

程序运行结束后会显示详细的统计信息：
- 更新成功数量
- 无需更新数量
- 空链接数量
- 保留原图数量
- 处理失败数量
- 重复链接数量
- URL相同跳过数量
- 新获取图片数量

## 注意事项

1. 运行前请确保：
   - API令牌有效
   - 网络连接正常
   - 表格权限正确

2. 程序特性：
   - 每次运行都是全新开始
   - 运行结束后自动清理缓存
   - 支持中断后继续运行

3. 性能考虑：
   - 设置了请求间隔，避免请求过于频繁
   - 使用流式处理，减少内存占用
   - 智能重试机制，提高成功率

## 更新日志

### V3.0
- 新增分页获取数据功能
- 添加运行时缓存管理
- 优化图片URL处理逻��
- 增强错误处理机制
- 添加图片URL验证功能
- 完善统计信息输出