# Amazon 产品图片获取工具 V3

## 功能特点

1. **分页获取数据**
   - 突破1000条数据限制
   - 自动分页处理大量数据

2. **智能缓存管理**
   - 运行时缓存重复链接
   - 自动复用已获取的图片URL
   - 程序结束时自动清理缓存

3. **图片URL处理**
   - 自动获取最高质量图片
   - 支持多种图片URL模式匹配
   - 自动验证图片URL有效性

4. **错误处理机制**
   - 完整的重试机制
   - 详细的错误日志
   - 异常情况自动恢复

5. **多站点支持**
   - 支持全球19个亚马逊站点
   - 自动识别站点信息
   - 针对性处理不同站点特征

## 使用方法

1. **配置参数**
   ```python
   SERVER_URL = 'https://cloud.seatable.cn'
   API_TOKEN = '你的API令牌'
   TABLE_NAME = '表格名称'
   ```

2. **运行程序**
   ```bash
   python get_amazon_images_v3.py
   ```

## 运行要求

- Python 3.6+
- 依赖包：
  - seatable-api
  - requests
  - urllib3

## 主要改进

1. **V3版本新特性**
   - 分页获取数据，突破1000条限制
   - 运行时缓存管理，提高效率
   - 图片URL验证功能
   - 更完善的错误处理

2. **性能优化**
   - 使用会话（Session）管理请求
   - 流式读取响应内容
   - 智能延迟控制

3. **可靠性提升**
   - 更强大的重试机制
   - 完整的异常处理
   - 自动恢复机制

## 统计信息

程序运行结束后会显示详细的统计信息：
- 更新成功数量
- 无需更新数量
- 空链接数量
- 保留原图数量
- 处理失败数量
- 重复链接数量
- URL相同跳过数量
- 新获取图片数量

## 注意事项

1. 运行前请确保：
   - API令牌有效
   - 网络连接正常
   - 表格权限正确

2. 程序特性：
   - 每次运行都是全新开始
   - 运行结束后自动清理缓存
   - 支持中断后继续运行

3. 性能考虑：
   - 设置了请求间隔，避免请求过于频繁
   - 使用流式处理，减少内存占用
   - 智能重试机制，提高成功率

## 更新日志

### V3.0
- 新增分页获取数据功能
- 添加运行时缓存管理
- 优化图片URL处理逻辑
- 增强错误处理机制
- 添加图片URL验证功能
- 完善统计信息输出